<app-card [showHeader]="false" blockClass="pc-component">
	<app-absolute-loader *ngIf="loading" />

	<table mat-table [dataSource]="elements">

		<ng-container matColumnDef="id">
			<th mat-header-cell *matHeaderCellDef> Id </th>
			<td mat-cell *matCellDef="let element"> {{element.id}} </td>
		</ng-container>

		<ng-container matColumnDef="user">
			<th mat-header-cell *matHeaderCellDef> User </th>
			<td mat-cell *matCellDef="let element"> {{element.user.name}} </td>
		</ng-container>

		<ng-container matColumnDef="amount">
			<th mat-header-cell *matHeaderCellDef> Amount </th>
			<td mat-cell *matCellDef="let element"> {{element.amount}} </td>
		</ng-container>

		<ng-container matColumnDef="paymentMethod">
			<th mat-header-cell *matHeaderCellDef> Payment Method </th>
			<td mat-cell *matCellDef="let element"> {{element.paymentMethod}} </td>
		</ng-container>

		<ng-container matColumnDef="status">
			<th mat-header-cell *matHeaderCellDef> Status </th>

			<td mat-cell *matCellDef="let element">

				<div *ngIf="editablePaymentId !== element._id" class="px-3 py-1 rounded-full w-max " [ngClass]="{
					'bg-emerald-200': element.status =='success',
					'bg-red-200': element.status == 'failed',
					'bg-sky-200': element.status == 'queued',
					'bg-gray-200': element.status == 'pending'
				  }">
					{{element.status}}
				</div>

				<mat-form-field class="mat-table-select" subscriptSizing="dynamic" *ngIf="editablePaymentId === element._id;">
					<mat-select  [(ngModel)]="editablePaymentNewStatus" class="table-select">
						<mat-option value="pending">Pending</mat-option>
						<mat-option disabled value="queued">Queued</mat-option>
						<mat-option value="failed">Failed</mat-option>
						<mat-option value="success">Success</mat-option>
					</mat-select>
				</mat-form-field>
			</td>
		</ng-container>

		<ng-container matColumnDef="currency">
			<th mat-header-cell *matHeaderCellDef> Currency </th>
			<td mat-cell *matCellDef="let element"> {{element.currency}} </td>
		</ng-container>

		<ng-container matColumnDef="date">
			<th mat-header-cell *matHeaderCellDef> Date </th>
			<td mat-cell *matCellDef="let element"> {{element.createdAt | date:'medium' }} </td>
		</ng-container>

		<ng-container matColumnDef="operation">
			<th mat-header-cell *matHeaderCellDef> Operation </th>
			<td mat-cell *matCellDef="let element">
				<button (click)="editElement(element)" mat-icon-button aria-label="Edit"
					*ngIf="isAdminTable && editablePaymentId !== element._id">
					<mat-icon>edit</mat-icon>
				</button>
				<button (click)="saveElement()" mat-icon-button aria-label="Save"
					*ngIf="isAdminTable && editablePaymentId == element._id">
					<mat-icon>save-rounded</mat-icon>
				</button>
				<a [routerLink]="['/payments',element.id]" *ngIf="!isAdminTable">
					<button mat-icon-button aria-label="View">
						<mat-icon>visibility-rounded</mat-icon>
					</button>
				</a>
			</td>
		</ng-container>


		<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
		<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
	</table>


	<div *ngIf="showPagination" class="flex items-center justify-end mt-5">
		<button (click)="getData()" mat-icon-button aria-label="Refresh">
			<mat-icon>refresh-rounded</mat-icon>
		</button>
		<mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons [pageSize]="paginationDto.limit"
			[length]="pagination?.totalElements" [pageIndex]="paginationDto.page-1" (page)="changePage($event)"
			aria-label="Select page of periodic elements">
		</mat-paginator>
	</div>
</app-card>
